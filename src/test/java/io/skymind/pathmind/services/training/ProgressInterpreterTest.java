package io.skymind.pathmind.services.training;

import io.skymind.pathmind.data.Policy;
import io.skymind.pathmind.services.training.progress.ProgressInterpreter;
import org.junit.Test;

import java.time.Clock;
import java.time.LocalDateTime;
import java.time.ZoneOffset;
import java.time.ZonedDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Map;

import static org.junit.Assert.assertEquals;

public class ProgressInterpreterTest {
    @Test
    public void testInterpreter(){
        final Policy policy = ProgressInterpreter.interpret(Map.entry(name, fileContents));

        final LocalDateTime utcTime = LocalDateTime.parse("2019-08-05_13-56-45", DateTimeFormatter.ofPattern("uuuu-MM-dd_HH-mm-ss"));
        final LocalDateTime time = ZonedDateTime.ofInstant(utcTime.toInstant(ZoneOffset.UTC), Clock.systemDefaultZone().getZone()).toLocalDateTime();

        assertEquals(time, policy.getStartedAt());
        assertEquals(17, policy.getScores().size());
        assertEquals(76.00000045448542, policy.getScores().get(16).getMax(), 0);
    }


    static String name = "PPO_CoffeeEnvironment_0_gamma=0.99,lr=5e-05,sgd_minibatch_size=128_2019-08-05_13-56-455cdir_3f";
    static String fileContents = "episode_reward_max,episode_reward_min,episode_reward_mean,episode_len_mean,episodes_this_iter,policy_reward_mean,custom_metrics,sampler_perf,off_policy_estimator,num_metric_batches_dropped,info,timesteps_this_iter,done,timesteps_total,episodes_total,training_iteration,experiment_id,date,timestamp,time_this_iter_s,time_total_s,pid,hostname,node_ip,config,time_since_restore,timesteps_since_restore,iterations_since_restore,num_healthy_workers\n" +
            "nan,nan,nan,nan,0,{},{},{},{},0,\"{'num_steps_trained': 3968, 'num_steps_sampled': 4000, 'sample_time_ms': 28647.558, 'load_time_ms': 51.642, 'grad_time_ms': 5738.431, 'update_time_ms': 4035.852, 'learner': {'default_policy': {'cur_kl_coeff': 0.19999995827674866, 'cur_lr': 4.999999873689376e-05, 'total_loss': 15.454439163208008, 'policy_loss': -0.008411900140345097, 'vf_loss': 15.459821701049805, 'vf_explained_var': 0.025035716593265533, 'kl': 0.015141604468226433, 'entropy': 1.3715122938156128}}}\",4000,False,4000,0,1,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-57-34,1565006254,38.53461813926697,38.53461813926697,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",38.53461813926697,4000,1,7\n" +
            "73.55000030994415,-16.550001453608274,42.721428357596906,720.0,7,{},{},\"{'mean_env_wait_ms': 31.50434320775454, 'mean_processing_ms': 0.7439789673494764, 'mean_inference_ms': 7.243981354017097}\",{},0,\"{'num_steps_trained': 7936, 'num_steps_sampled': 8000, 'sample_time_ms': 24435.497, 'load_time_ms': 26.389, 'grad_time_ms': 5382.135, 'update_time_ms': 2023.406, 'learner': {'default_policy': {'cur_kl_coeff': 0.19999995827674866, 'cur_lr': 4.999999873689376e-05, 'total_loss': 6.15709114074707, 'policy_loss': -0.0064767529256641865, 'vf_loss': 6.160492897033691, 'vf_explained_var': 0.2401866316795349, 'kl': 0.015380539931356907, 'entropy': 1.3586773872375488}}}\",4000,False,8000,7,2,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-57-59,1565006279,25.282663822174072,63.81728196144104,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",63.81728196144104,8000,2,7\n" +
            "73.55000030994415,-57.94999961927533,41.59230767792234,720.0,6,{},{},\"{'mean_env_wait_ms': 30.11887224224625, 'mean_processing_ms': 0.7494040284901609, 'mean_inference_ms': 6.984016781402663}\",{},0,\"{'num_steps_trained': 11904, 'num_steps_sampled': 12000, 'sample_time_ms': 22378.953, 'load_time_ms': 17.856, 'grad_time_ms': 5207.216, 'update_time_ms': 1352.964, 'learner': {'default_policy': {'cur_kl_coeff': 0.19999995827674866, 'cur_lr': 4.999999873689376e-05, 'total_loss': 83.20420837402344, 'policy_loss': -0.0023638696875423193, 'vf_loss': 83.20614624023438, 'vf_explained_var': 0.46350395679473877, 'kl': 0.002101152203977108, 'entropy': 1.3621864318847656}}}\",4000,False,12000,13,3,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-58-23,1565006303,23.153534650802612,86.97081661224365,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",86.97081661224365,12000,3,7\n" +
            "73.55000030994415,-142.84999971091747,33.600000112503764,720.0,7,{},{},\"{'mean_env_wait_ms': 29.173390885405173, 'mean_processing_ms': 0.7536665874834255, 'mean_inference_ms': 6.760461022029444}\",{},0,\"{'num_steps_trained': 15872, 'num_steps_sampled': 16000, 'sample_time_ms': 21166.596, 'load_time_ms': 13.571, 'grad_time_ms': 5117.412, 'update_time_ms': 1017.493, 'learner': {'default_policy': {'cur_kl_coeff': 0.09999997913837433, 'cur_lr': 4.999999873689376e-05, 'total_loss': 31.832469940185547, 'policy_loss': -0.00010670481424313039, 'vf_loss': 31.832483291625977, 'vf_explained_var': 0.5013302564620972, 'kl': 0.0009444819297641516, 'entropy': 1.3559120893478394}}}\",4000,False,16000,20,4,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-58-45,1565006325,22.40723729133606,109.37805390357971,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",109.37805390357971,16000,4,7\n" +
            "73.55000030994415,-142.84999971091747,39.36600016742945,720.0,5,{},{},\"{'mean_env_wait_ms': 28.629553987192757, 'mean_processing_ms': 0.7553365273361413, 'mean_inference_ms': 6.632484784694643}\",{},0,\"{'num_steps_trained': 19840, 'num_steps_sampled': 20000, 'sample_time_ms': 20378.932, 'load_time_ms': 10.995, 'grad_time_ms': 5057.189, 'update_time_ms': 816.256, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 6.160811901092529, 'policy_loss': -0.003305489430204034, 'vf_loss': 6.1632771492004395, 'vf_explained_var': 0.3260974884033203, 'kl': 0.016803447157144547, 'entropy': 1.3370875120162964}}}\",4000,False,20000,25,5,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-59-07,1565006347,22.07375979423523,131.45181369781494,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",131.45181369781494,20000,5,7\n" +
            "73.55000030994415,-142.84999971091747,43.10483891865419,720.0,6,{},{},\"{'mean_env_wait_ms': 28.153777660160287, 'mean_processing_ms': 0.7538873608240442, 'mean_inference_ms': 6.5097529901780495}\",{},0,\"{'num_steps_trained': 23808, 'num_steps_sampled': 24000, 'sample_time_ms': 20153.516, 'load_time_ms': 9.309, 'grad_time_ms': 5017.828, 'update_time_ms': 682.078, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 4.651143550872803, 'policy_loss': -0.0027758709620684385, 'vf_loss': 4.653210163116455, 'vf_explained_var': -0.14900656044483185, 'kl': 0.014180832542479038, 'entropy': 1.3178678750991821}}}\",4000,False,24000,31,6,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-59-31,1565006371,23.874744176864624,155.32655787467957,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",155.32655787467957,24000,6,7\n" +
            "73.55000030994415,-142.84999971091747,44.954166890121996,720.0,5,{},{},\"{'mean_env_wait_ms': 27.558437384638705, 'mean_processing_ms': 0.7397278275983027, 'mean_inference_ms': 6.361854727830031}\",{},0,\"{'num_steps_trained': 27776, 'num_steps_sampled': 28000, 'sample_time_ms': 18429.882, 'load_time_ms': 8.083, 'grad_time_ms': 5010.651, 'update_time_ms': 585.796, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 4.585755825042725, 'policy_loss': -0.0048265052028000355, 'vf_loss': 4.5899529457092285, 'vf_explained_var': -0.004428728949278593, 'kl': 0.012577183544635773, 'entropy': 1.3074593544006348}}}\",4000,False,28000,36,7,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-59-44,1565006384,13.074817419052124,168.4013752937317,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",168.4013752937317,28000,7,7\n" +
            "73.55000030994415,-142.84999971091747,43.730488053273135,720.0,5,{},{},\"{'mean_env_wait_ms': 26.756243495893823, 'mean_processing_ms': 0.7251657940689111, 'mean_inference_ms': 6.216892014084882}\",{},0,\"{'num_steps_trained': 31744, 'num_steps_sampled': 32000, 'sample_time_ms': 16828.457, 'load_time_ms': 7.158, 'grad_time_ms': 5015.56, 'update_time_ms': 513.159, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 23.329601287841797, 'policy_loss': -0.003566735191270709, 'vf_loss': 23.332904815673828, 'vf_explained_var': 0.6749038696289062, 'kl': 0.005246768705546856, 'entropy': 1.3380765914916992}}}\",4000,False,32000,41,8,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_13-59-55,1565006395,10.684821367263794,179.08619666099548,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",179.08619666099548,32000,8,7\n" +
            "73.55000030994415,-142.84999971091747,44.49456547840458,720.0,5,{},{},\"{'mean_env_wait_ms': 25.916500495240115, 'mean_processing_ms': 0.7066065743687038, 'mean_inference_ms': 6.068959705480699}\",{},0,\"{'num_steps_trained': 35712, 'num_steps_sampled': 36000, 'sample_time_ms': 15499.401, 'load_time_ms': 6.448, 'grad_time_ms': 5010.379, 'update_time_ms': 456.804, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 12.180947303771973, 'policy_loss': -0.00860806554555893, 'vf_loss': 12.188983917236328, 'vf_explained_var': 0.35227909684181213, 'kl': 0.01145482249557972, 'entropy': 1.3736392259597778}}}\",4000,False,36000,46,9,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-05,1565006405,9.852866649627686,188.93906331062317,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",188.93906331062317,36000,9,7\n" +
            "73.55000030994415,-142.84999971091747,47.37870398446642,720.0,8,{},{},\"{'mean_env_wait_ms': 24.71571176435761, 'mean_processing_ms': 0.682724600338315, 'mean_inference_ms': 5.87961117695128}\",{},0,\"{'num_steps_trained': 39680, 'num_steps_sampled': 40000, 'sample_time_ms': 14410.403, 'load_time_ms': 5.872, 'grad_time_ms': 5024.869, 'update_time_ms': 411.65, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 5.925291061401367, 'policy_loss': -0.005645114462822676, 'vf_loss': 5.93023157119751, 'vf_explained_var': -0.0018375247018411756, 'kl': 0.014077365398406982, 'entropy': 1.36055326461792}}}\",4000,False,40000,54,10,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-14,1565006414,9.78106427192688,198.72012758255005,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",198.72012758255005,40000,10,7\n" +
            "73.55000030994415,-142.84999971091747,48.631034767383646,720.0,4,{},{},\"{'mean_env_wait_ms': 24.156165484583447, 'mean_processing_ms': 0.6701093869894641, 'mean_inference_ms': 5.791475245293059}\",{},0,\"{'num_steps_trained': 43648, 'num_steps_sampled': 44000, 'sample_time_ms': 12007.635, 'load_time_ms': 0.776, 'grad_time_ms': 4938.32, 'update_time_ms': 8.561, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 3.890150308609009, 'policy_loss': -0.006084981840103865, 'vf_loss': 3.895540714263916, 'vf_explained_var': 0.2528560161590576, 'kl': 0.01388914231210947, 'entropy': 1.353388786315918}}}\",4000,False,44000,58,11,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-24,1565006424,9.510458707809448,208.2305862903595,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",208.2305862903595,44000,11,7\n" +
            "76.00000045448542,-142.84999971091747,50.40873045438812,720.0,5,{},{},\"{'mean_env_wait_ms': 23.527198929343754, 'mean_processing_ms': 0.6572513930393622, 'mean_inference_ms': 5.700084543528351}\",{},0,\"{'num_steps_trained': 47616, 'num_steps_sampled': 48000, 'sample_time_ms': 10437.725, 'load_time_ms': 0.731, 'grad_time_ms': 4947.052, 'update_time_ms': 7.94, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 4.767721176147461, 'policy_loss': -0.004861747846007347, 'vf_loss': 4.771748065948486, 'vf_explained_var': 0.021895136684179306, 'kl': 0.01669982448220253, 'entropy': 1.299547791481018}}}\",4000,False,48000,63,12,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-34,1565006434,9.654046773910522,217.88463306427002,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",217.88463306427002,48000,12,7\n" +
            "76.00000045448542,-142.84999971091747,51.67173943560624,720.0,6,{},{},\"{'mean_env_wait_ms': 22.764212218949766, 'mean_processing_ms': 0.6418683519569264, 'mean_inference_ms': 5.5917977327767465}\",{},0,\"{'num_steps_trained': 51584, 'num_steps_sampled': 52000, 'sample_time_ms': 9058.409, 'load_time_ms': 0.72, 'grad_time_ms': 4954.602, 'update_time_ms': 7.625, 'learner': {'default_policy': {'cur_kl_coeff': 0.049999989569187164, 'cur_lr': 4.999999873689376e-05, 'total_loss': 4.521393775939941, 'policy_loss': -0.005680135451257229, 'vf_loss': 4.525986194610596, 'vf_explained_var': 0.021469950675964355, 'kl': 0.021747004240751266, 'entropy': 1.285779595375061}}}\",4000,False,52000,69,13,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-43,1565006443,9.426926136016846,227.31155920028687,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",227.31155920028687,52000,13,7\n" +
            "76.00000045448542,-142.84999971091747,52.001370168814105,720.0,4,{},{},\"{'mean_env_wait_ms': 22.243265265965714, 'mean_processing_ms': 0.63142641597383, 'mean_inference_ms': 5.519904109177788}\",{},0,\"{'num_steps_trained': 55552, 'num_steps_sampled': 56000, 'sample_time_ms': 7740.187, 'load_time_ms': 0.721, 'grad_time_ms': 4971.096, 'update_time_ms': 7.086, 'learner': {'default_policy': {'cur_kl_coeff': 0.07500001043081284, 'cur_lr': 4.999999873689376e-05, 'total_loss': 32.204627990722656, 'policy_loss': -0.008407571353018284, 'vf_loss': 32.21223068237305, 'vf_explained_var': 0.26705631613731384, 'kl': 0.01070893369615078, 'entropy': 1.3050724267959595}}}\",4000,False,56000,73,14,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-00-52,1565006452,9.377439260482788,236.68899846076965,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",236.68899846076965,56000,14,7\n" +
            "76.00000045448542,-142.84999971091747,51.65925957515468,720.0,8,{},{},\"{'mean_env_wait_ms': 21.33755009320627, 'mean_processing_ms': 0.6132979757555627, 'mean_inference_ms': 5.395057471658779}\",{},0,\"{'num_steps_trained': 59520, 'num_steps_sampled': 60000, 'sample_time_ms': 6455.147, 'load_time_ms': 0.721, 'grad_time_ms': 5021.286, 'update_time_ms': 6.468, 'learner': {'default_policy': {'cur_kl_coeff': 0.07500001043081284, 'cur_lr': 4.999999873689376e-05, 'total_loss': 6.795469760894775, 'policy_loss': -0.008883158676326275, 'vf_loss': 6.8028130531311035, 'vf_explained_var': 0.037945281714200974, 'kl': 0.020527329295873642, 'entropy': 1.326971173286438}}}\",4000,False,60000,81,15,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-01-02,1565006462,9.714128494262695,246.40312695503235,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",246.40312695503235,60000,15,7\n" +
            "76.00000045448542,-142.84999971091747,52.052907296478054,720.0,5,{},{},\"{'mean_env_wait_ms': 20.775458511381974, 'mean_processing_ms': 0.6016199397551668, 'mean_inference_ms': 5.316573533817188}\",{},0,\"{'num_steps_trained': 63488, 'num_steps_sampled': 64000, 'sample_time_ms': 4997.252, 'load_time_ms': 0.704, 'grad_time_ms': 5044.456, 'update_time_ms': 5.816, 'learner': {'default_policy': {'cur_kl_coeff': 0.11249998211860657, 'cur_lr': 4.999999873689376e-05, 'total_loss': 8.972010612487793, 'policy_loss': -0.006330498959869146, 'vf_loss': 8.977433204650879, 'vf_explained_var': 0.35307955741882324, 'kl': 0.00807966198772192, 'entropy': 1.3291678428649902}}}\",4000,False,64000,86,16,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-01-12,1565006472,9.516275405883789,255.91940236091614,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",255.91940236091614,64000,16,7\n" +
            "76.00000045448542,-142.84999971091747,52.31141336509229,720.0,6,{},{},\"{'mean_env_wait_ms': 20.259289600297112, 'mean_processing_ms': 0.5908885694878749, 'mean_inference_ms': 5.248458237872142}\",{},0,\"{'num_steps_trained': 67456, 'num_steps_sampled': 68000, 'sample_time_ms': 4647.28, 'load_time_ms': 0.699, 'grad_time_ms': 5034.638, 'update_time_ms': 5.495, 'learner': {'default_policy': {'cur_kl_coeff': 0.11249998211860657, 'cur_lr': 4.999999873689376e-05, 'total_loss': 6.532220840454102, 'policy_loss': -0.0036476687528192997, 'vf_loss': 6.534155368804932, 'vf_explained_var': 0.017287513241171837, 'kl': 0.01522785983979702, 'entropy': 1.2874178886413574}}}\",4000,False,68000,92,17,7e457b3ed37a47238dbbc7c24f456a3c,2019-08-05_14-01-21,1565006481,9.474494457244873,265.393896818161,51469,localhost.localdomain,192.168.72.147,\"{'monitor': False, 'log_level': 'INFO', 'callbacks': {'on_episode_start': None, 'on_episode_step': None, 'on_episode_end': None, 'on_sample_end': None, 'on_train_result': None, 'on_postprocess_traj': None}, 'ignore_worker_failures': False, 'use_eager': False, 'model': {'conv_filters': None, 'conv_activation': 'relu', 'fcnet_activation': 'tanh', 'fcnet_hiddens': [256, 256], 'free_log_std': False, 'squash_to_range': False, 'use_lstm': False, 'max_seq_len': 20, 'lstm_cell_size': 256, 'lstm_use_prev_action_reward': False, 'framestack': True, 'dim': 84, 'grayscale': False, 'zero_mean': True, 'custom_preprocessor': None, 'custom_model': None, 'custom_options': {}}, 'optimizer': {}, 'gamma': 0.99, 'horizon': None, 'soft_horizon': False, 'env_config': {}, 'env': 'CoffeeEnvironment', 'clip_rewards': None, 'clip_actions': True, 'preprocessor_pref': 'deepmind', 'lr': 5e-05, 'evaluation_interval': None, 'evaluation_num_episodes': 10, 'evaluation_config': {}, 'num_workers': 7, 'num_gpus': 0, 'num_cpus_per_worker': 1, 'num_gpus_per_worker': 0, 'custom_resources_per_worker': {}, 'num_cpus_for_driver': 1, 'num_envs_per_worker': 1, 'sample_batch_size': 200, 'train_batch_size': 4000, 'batch_mode': 'truncate_episodes', 'sample_async': False, 'observation_filter': 'NoFilter', 'synchronize_filters': True, 'tf_session_args': {'intra_op_parallelism_threads': 2, 'inter_op_parallelism_threads': 2, 'gpu_options': {'allow_growth': True}, 'log_device_placement': False, 'device_count': {'CPU': 1}, 'allow_soft_placement': True}, 'local_tf_session_args': {'intra_op_parallelism_threads': 8, 'inter_op_parallelism_threads': 8}, 'compress_observations': False, 'collect_metrics_timeout': 180, 'metrics_smoothing_episodes': 100, 'remote_worker_envs': False, 'remote_env_batch_wait_ms': 0, 'min_iter_time_s': 0, 'timesteps_per_iteration': 0, 'input': 'sampler', 'input_evaluation': ['is', 'wis'], 'postprocess_inputs': False, 'shuffle_buffer_size': 0, 'output': None, 'output_compress_columns': ['obs', 'new_obs'], 'output_max_file_size': 67108864, 'multiagent': {'policies': {}, 'policy_mapping_fn': None, 'policies_to_train': None}, 'use_gae': True, 'lambda': 1.0, 'kl_coeff': 0.2, 'sgd_minibatch_size': 128, 'num_sgd_iter': 30, 'lr_schedule': None, 'vf_share_layers': False, 'vf_loss_coeff': 1.0, 'entropy_coeff': 0.0, 'clip_param': 0.3, 'vf_clip_param': 10.0, 'grad_clip': None, 'kl_target': 0.01, 'simple_optimizer': False, 'straggler_mitigation': False}\",265.393896818161,68000,17,7\n";
}